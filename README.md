# System Design - Cоциальная сеть для путешественников

## Функциональные требования:
- web/mob ui
- загрузка фотографий
- создание/обновление постов (фотографии, текст 1000 символов, место путешествия - город/страна - гео посмотреть варианты?)
- поставить оценку поста (лайк)
- оставить коментарий под постом
- подписка/отписка на пользователей
- получение ленты популярных мест (например город/страна/гео?)
- получение списка постов по месту
- получение списка постов других пользователей в обратном хронологическом порядке, основанной на подписке
- получение списка постов одного пользователя в обратном хронологическом порядке



## Нефункциональные требования:
- DAU ~ 10М
- Активность пользователей: 
    1. В среднем пользователь просматривает просматривает ленту (постов + мест + комментарии) ~ 50 запросов в день
    2. В среднем пользователь оценивает посты ~ 5 запросов в день
    3. В среднем пользователь пишет комментарий 1 раз в день ~ 0.5 запрос в день 
    4. В среднем пользователь создает/обновляет посты несколько раз в неделю ~ 0.1 запрос в день
- СНГ аудитория
- Сезонность:
    1. годовая - сезоны отпусков и праздников (пики лето/нг, минимум осень/весна)
    2. недельная - пик выходные
    3. суточная - пик вечер
- Данные храним всегда
- Лимит: 
    1. 1000 подписчиков
    2. 3 фото в посте
    3. 1000 символов описание поста
- SLO: 
    1. доступность 99.9% - 43 минуты простоя в месяц 
    2. Фиды/списки: P95 ≤ 1 с, P99 ≤ 3 с
    3. write-операции (лайк/коммент): P95 ≤ 300 мс, P99 ≤ 700 мс

## API

```
GET /feed/popular
GET /feed/following
POST /likes
POST /comments
POST /posts
POST /uploads/image
```

## Entities

```
Post:
    id: uuid
    description: varchar
    places: [Place]
    images: urls [jsonb]
    likes_count: int
    updated_at
    created_at

Place: 
    id: uuid
    name: varchar
    geo: ?


```

## Оценка нагрузки:

- RPS (upper bound):
     1. write (post): 10000000 * 7 / 86400 = 810
     2. write (images): 10000000 * 3 * 0.1 / 86400 = 35
     3. read:  10000000 * 50 / 86400 = 5787

- Traffic (upper bound):
    1. write: 1KB (пост) * 810 = 810 Kb/s
    2. write 3MB (изображения ~3) * 35 = 105 Mb/s ?
    3. read: 1Kb * 100 (100 постов) * 5787 =  578 Mb/s ?